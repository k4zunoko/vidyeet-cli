# vidyeet-cli

**Mux Videoå¯¾å¿œå‹•ç”»ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰CLIãƒ„ãƒ¼ãƒ«ï¼ˆRustå­¦ç¿’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰**

[![Rust](https://img.shields.io/badge/rust-2024%20edition-orange.svg)](https://www.rust-lang.org)

## æ¦‚è¦

`vidyeet-cli`ã¯ã€[Mux Video](https://www.mux.com/)ã®APIã‚’åˆ©ç”¨ã—ã¦å‹•ç”»ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ä½œè€…ã®**Rustã®å­¦ç¿’éç¨‹**ã§ä½œæˆã•ã‚ŒãŸã‚‚ã®ã§ã€å®Ÿè·µçš„ã«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚„Rustã®è¨€èªæ©Ÿèƒ½ã‚’å–ã‚Šå…¥ã‚Œã¦ã„ã¾ã™ã€‚

## ç›®æ¬¡

- [ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«](#ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«)
- [ä½¿ã„æ–¹](#ä½¿ã„æ–¹)
- [è¨­è¨ˆæ–¹é‡](#è¨­è¨ˆæ–¹é‡)
- [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
- [ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°](#ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°)
- [é–‹ç™º](#é–‹ç™º)
- [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯](#æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯)
- [ãƒ©ã‚¤ã‚»ãƒ³ã‚¹](#ãƒ©ã‚¤ã‚»ãƒ³ã‚¹)

---

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### å‰ææ¡ä»¶

- Rust 2024 editionä»¥é™ï¼ˆ`rustc 1.75+`æ¨å¥¨ï¼‰
- Mux ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆ[https://mux.com/](https://mux.com/)ï¼‰

### ãƒ“ãƒ«ãƒ‰

```powershell
git clone https://github.com/k4zunoko/vidyeet-cli.git
cd vidyeet-cli

cargo build --release
```

---

## ä½¿ã„æ–¹

### 1. ãƒ­ã‚°ã‚¤ãƒ³

Muxãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§å–å¾—ã—ãŸAccess Token IDã¨Secretã‚’ä½¿ã£ã¦èªè¨¼ã—ã¾ã™ã€‚

```powershell
vidyeet login
```

å¯¾è©±å½¢å¼ã§èªè¨¼æƒ…å ±ã‚’å…¥åŠ›ã—ã¾ã™ï¼š

```
Enter your Mux Access Token ID: abc123xyz
Enter your Mux Access Token Secret: ****
Authenticating...
âœ“ Login successful!
```

**Access Tokenã®å–å¾—æ–¹æ³•:**
1. [Mux Dashboard](https://dashboard.mux.com/)ã«ãƒ­ã‚°ã‚¤ãƒ³
2. **Settings â†’ Access Tokens** ã¸ç§»å‹•
3. **Generate new token** ã‚’ã‚¯ãƒªãƒƒã‚¯
4. Token IDã¨Secretã‚’ã‚³ãƒ”ãƒ¼

### 2. å‹•ç”»ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

```powershell
vidyeet upload video.mp4
```

**å‡ºåŠ›ä¾‹ï¼ˆé€šå¸¸ãƒ¢ãƒ¼ãƒ‰ï¼‰:**

```
âœ“ Upload completed successfully!
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Asset ID: asset_abc123xyz

  ğŸ¬ HLS Streaming URL (ready now):
     https://stream.mux.com/xyz123.m3u8

  ğŸ“¦ MP4 Download URL:
     Status: âœ“ Ready
     https://stream.mux.com/xyz123/highest.mp4
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

**å‡ºåŠ›ä¾‹ï¼ˆ--machineãƒ•ãƒ©ã‚°æŒ‡å®šæ™‚ï¼‰:**

```powershell
vidyeet --machine upload video.mp4 | ConvertFrom-Json
```

```json
{
  "success": true,
  "command": "upload",
  "asset_id": "asset_abc123xyz",
  "playback_id": "xyz123",
  "hls_url": "https://stream.mux.com/xyz123.m3u8",
  "mp4_url": "https://stream.mux.com/xyz123/highest.mp4",
  "mp4_status": "ready",
  "file_path": "video.mp4",
  "file_size": 10485760,
  "file_format": "mp4",
  "deleted_old_videos": 0
}
```

### 3. å‹•ç”»ãƒªã‚¹ãƒˆã‚’å–å¾—

ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ã®å‹•ç”»ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
vidyeet list
```

### 4. å‹•ç”»ã®è©³ç´°ã‚’è¡¨ç¤º

æŒ‡å®šã—ãŸã‚¢ã‚»ãƒƒãƒˆIDã®è©³ç´°æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
vidyeet show <asset_id>
```

**è¡¨ç¤ºã•ã‚Œã‚‹æƒ…å ±:**

```
Asset Details:
==============
Asset ID:       lJ4bGGsp7ZlPf02nMg015W02iHQLN9XnuuLRBsPS00xqd68
Status:         ready
Duration:       0:24 (23.86s)
Aspect Ratio:   16:9
Video Quality:  basic
Created At:     2021-01-05 12:46:08 +09:00

Playback Information:
--------------------
Playback ID #1: vAFLI2eKFFicXX00iHBS2vqt5JjJGg5HV6fQ4Xijgt1I
  Policy:       public
HLS URL:        https://stream.mux.com/vAFLI2eKFFicXX00iHBS2vqt5JjJGg5HV6fQ4Xijgt1I.m3u8
MP4 URL:        https://stream.mux.com/vAFLI2eKFFicXX00iHBS2vqt5JjJGg5HV6fQ4Xijgt1I/high.mp4

Tracks:
-------
Track #1: video (duration: 23.82s)
Track #2: audio (duration: 23.82s)
```

### 5. å‹•ç”»ã‚’å‰Šé™¤

æŒ‡å®šã—ãŸã‚¢ã‚»ãƒƒãƒˆIDã®å‹•ç”»ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

```powershell
vidyeet delete <asset_id>
```

**ç¢ºèªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ:**

```
âš ï¸  WARNING: You are about to delete the following asset:
   Asset ID: asset_abc123xyz

This action cannot be undone. All video data will be permanently deleted.

Type 'yes' to confirm deletion: 
```

**å¼·åˆ¶å‰Šé™¤ï¼ˆç¢ºèªã‚’ã‚¹ã‚­ãƒƒãƒ—ï¼‰:**

```powershell
vidyeet delete <asset_id> --force
```

### 6. ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ

èªè¨¼æƒ…å ±ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

```powershell
vidyeet logout
```

### 7. ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª

èªè¨¼çŠ¶æ…‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

```powershell
vidyeet status
```

### 8. æ©Ÿæ¢°å¯èª­å‡ºåŠ›ï¼ˆã‚¹ã‚¯ãƒªãƒ—ãƒˆå‘ã‘ï¼‰

`--machine`ãƒ•ãƒ©ã‚°ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€JSONå½¢å¼ã§çµæœã‚’å‡ºåŠ›ã—ã¾ã™ã€‚

```powershell
vidyeet --machine upload video.mp4
vidyeet --machine status
vidyeet --machine list
vidyeet --machine show <asset_id>
vidyeet --machine delete <asset_id> --force
```

**æ³¨æ„**: `--machine`ã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ•ãƒ©ã‚°ã®ãŸã‚ã€ã‚³ãƒãƒ³ãƒ‰åã®å‰ã«æŒ‡å®šã—ã¾ã™ã€‚

### 9. ãƒ˜ãƒ«ãƒ—

```powershell
vidyeet help
```

---

## è¨­è¨ˆæ–¹é‡

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ä»¥ä¸‹ã®è¨­è¨ˆåŸå‰‡ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ã€‚

### Clean Architectureï¼ˆãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹é€ ï¼‰

4å±¤æ§‹æˆã§ä¾å­˜æ–¹å‘ã‚’å³å¯†ã«ç®¡ç†ã—ã¦ã„ã¾ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤                     â”‚
â”‚  main.rs, cli.rs, error_severity.rs     â”‚
â”‚  (ãƒ¦ãƒ¼ã‚¶ãƒ¼I/Oã€çµ‚äº†ã‚³ãƒ¼ãƒ‰æ±ºå®š)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤                       â”‚
â”‚  commands/ (login, logout, upload)      â”‚
â”‚  (ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å®Ÿè£…ã€anyhowã§ã‚¨ãƒ©ãƒ¼é›†ç´„)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤    â”‚ è¨­å®šå±¤        â”‚ã‚¤ãƒ³ãƒ•ãƒ©å±¤ â”‚
â”‚ domain/      â”‚ config/      â”‚ api/      â”‚
â”‚ (ãƒ“ã‚¸ãƒã‚¹     â”‚ (é™çš„/å‹•çš„    â”‚(HTTPé€šä¿¡ã€â”‚
â”‚  ãƒ«ãƒ¼ãƒ«)      â”‚ è¨­å®š)        â”‚ èªè¨¼)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¾å­˜æ–¹å‘ã®åŸå‰‡:**
- å¤–å´ã‹ã‚‰å†…å´ã®ã¿ä¾å­˜ï¼ˆå†…å´ã¯å¤–å´ã‚’çŸ¥ã‚‰ãªã„ï¼‰
- `ErrorSeverity`ã¯å…¨å±¤ã‹ã‚‰ä½¿ç”¨ã•ã‚Œã‚‹ç‹¬ç«‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥

#### çµ‚äº†ã‚³ãƒ¼ãƒ‰

| ã‚³ãƒ¼ãƒ‰ | ç¨®åˆ¥ | ä¾‹ |
|-------|------|---|
| 0 | æˆåŠŸ | - |
| 1 | ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚¨ãƒ©ãƒ¼ | ãƒ•ã‚¡ã‚¤ãƒ«ä¸æ­£ã€å½¢å¼ç„¡åŠ¹ |
| 2 | è¨­å®šã‚¨ãƒ©ãƒ¼ | ãƒˆãƒ¼ã‚¯ãƒ³ç„¡åŠ¹ã€è¨­å®šç ´æ |
| 3 | ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ | I/Oéšœå®³ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éšœå®³ |

#### ã‚¨ãƒ©ãƒ¼å‹

å„å±¤ã§å°‚ç”¨ã®ã‚¨ãƒ©ãƒ¼å‹ã‚’å®šç¾©ã—ã€`severity()`ã¨`hint()`ãƒ¡ã‚½ãƒƒãƒ‰ã§çµ±ä¸€çš„ã«å‡¦ç†ã—ã¾ã™ã€‚

- **DomainError**: ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«é•åï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
- **ConfigError**: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å•é¡Œï¼ˆèªè¨¼æƒ…å ±ã€TOMLè§£æï¼‰
- **InfraError**: å¤–éƒ¨é€šä¿¡ã‚¨ãƒ©ãƒ¼ï¼ˆHTTPã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
vidyeet-cli/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.rs                  # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
â”‚   â”œâ”€â”€ cli.rs                   # CLIå¼•æ•°è§£æã€å‡ºåŠ›åˆ¶å¾¡
â”‚   â”œâ”€â”€ error_severity.rs        # çµ‚äº†ã‚³ãƒ¼ãƒ‰æ±ºå®šãƒ­ã‚¸ãƒƒã‚¯ï¼ˆç‹¬ç«‹ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ commands/                # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ login.rs             # ãƒ­ã‚°ã‚¤ãƒ³ã‚³ãƒãƒ³ãƒ‰
â”‚   â”‚   â”œâ”€â”€ logout.rs            # ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã‚³ãƒãƒ³ãƒ‰
â”‚   â”‚   â”œâ”€â”€ upload.rs            # ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚³ãƒãƒ³ãƒ‰
â”‚   â”‚   â”œâ”€â”€ help.rs              # ãƒ˜ãƒ«ãƒ—ã‚³ãƒãƒ³ãƒ‰
â”‚   â”‚   â”œâ”€â”€ list.rs              # ã‚¢ã‚»ãƒƒãƒˆä¸€è¦§ã‚³ãƒãƒ³ãƒ‰
â”‚   â”‚   â”œâ”€â”€ status.rs            # ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒãƒ³ãƒ‰
â”‚   â”‚   â””â”€â”€ result.rs            # ã‚³ãƒãƒ³ãƒ‰çµæœå‹
â”‚   â”‚
â”‚   â”œâ”€â”€ domain/                  # ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ validator.rs         # ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”œâ”€â”€ formatter.rs         # ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
â”‚   â”‚   â””â”€â”€ error.rs             # DomainErrorå®šç¾©
â”‚   â”‚
â”‚   â”œâ”€â”€ config/                  # è¨­å®šå±¤
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ app.rs               # é™çš„è¨­å®šï¼ˆã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚å®šæ•°ï¼‰
â”‚   â”‚   â”œâ”€â”€ user.rs              # å‹•çš„è¨­å®šï¼ˆTOMLï¼‰
â”‚   â”‚   â””â”€â”€ error.rs             # ConfigErrorå®šç¾©
â”‚   â”‚
â”‚   â””â”€â”€ api/                     # ã‚¤ãƒ³ãƒ•ãƒ©å±¤
â”‚       â”œâ”€â”€ mod.rs
â”‚       â”œâ”€â”€ client.rs            # HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚       â”œâ”€â”€ auth.rs              # HTTP Basicèªè¨¼
â”‚       â”œâ”€â”€ types.rs             # APIå‹å®šç¾©
â”‚       â””â”€â”€ error.rs             # InfraErrorå®šç¾©
â”‚
â”œâ”€â”€ Cargo.toml
â””â”€â”€ README.md
```

### ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–“ã®ä¾å­˜é–¢ä¿‚

```
main.rs â†’ cli.rs â†’ commands/* â†’ {domain, config, api}
                  â†“
           error_severity.rs (å…¨å±¤ã‹ã‚‰å‚ç…§å¯èƒ½)
```

---

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ä¾å­˜ã‚¯ãƒ¬ãƒ¼ãƒˆ

| ã‚¯ãƒ¬ãƒ¼ãƒˆ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|---------|-----------|------|
| [anyhow](https://docs.rs/anyhow/) | 1.0 | ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã‚¨ãƒ©ãƒ¼é›†ç´„ |
| [thiserror](https://docs.rs/thiserror/) | 1.0 | æ§‹é€ åŒ–ã‚¨ãƒ©ãƒ¼å®šç¾©ï¼ˆderive macroï¼‰ |
| [serde](https://docs.rs/serde/) | 1.0 | JSON/TOMLã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ |
| [serde_json](https://docs.rs/serde_json/) | 1.0 | JSONå‡¦ç† |
| [toml](https://docs.rs/toml/) | 0.8 | TOMLè¨­å®šãƒ•ã‚¡ã‚¤ãƒ« |
| [dirs](https://docs.rs/dirs/) | 5.0 | ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å›ºæœ‰ãƒ‘ã‚¹å–å¾— |
| [reqwest](https://docs.rs/reqwest/) | 0.11 | HTTPé€šä¿¡ï¼ˆéåŒæœŸï¼‰ |
| [tokio](https://docs.rs/tokio/) | 1.0 | éåŒæœŸãƒ©ãƒ³ã‚¿ã‚¤ãƒ  |
| [base64](https://docs.rs/base64/) | 0.21 | HTTP Basicèªè¨¼ãƒ˜ãƒƒãƒ€ãƒ¼ç”Ÿæˆ |
| [chrono](https://docs.rs/chrono/) | 0.4 | æ—¥æ™‚å‡¦ç†ã¨ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å¤‰æ› |

### ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†ãƒ•ãƒ­ãƒ¼

```
1. ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
   â†“
2. èªè¨¼æƒ…å ±èª­è¾¼ï¼ˆconfig.tomlï¼‰
   â†“
3. Direct Upload URLä½œæˆï¼ˆPOST /video/v1/uploadsï¼‰
   â†“ [å®¹é‡åˆ¶é™ã‚¨ãƒ©ãƒ¼æ™‚]
   â”œâ†’ æœ€å¤ã‚¢ã‚»ãƒƒãƒˆå‰Šé™¤
   â””â†’ å†è©¦è¡Œ
   â†“
4. ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆPUTï¼‰
   â†“
5. ã‚¢ã‚»ãƒƒãƒˆä½œæˆå®Œäº†ã‚’ãƒãƒ¼ãƒªãƒ³ã‚°ï¼ˆ2ç§’é–“éš”ã€æœ€å¤§300ç§’ï¼‰
   â†“
6. HLS/MP4 URLå–å¾—
```

### æ©Ÿæ¢°å¯èª­å‡ºåŠ›ã®ä»•æ§˜

`--machine`ãƒ•ãƒ©ã‚°ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€JSONå½¢å¼ã§æ§‹é€ åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’æ¨™æº–å‡ºåŠ›ã«å‡ºåŠ›ã—ã¾ã™ã€‚

**å‡ºåŠ›å½¢å¼ã®é•ã„:**

- **é€šå¸¸å®Ÿè¡Œ**: äººé–“ãŒèª­ã¿ã‚„ã™ã„ç°¡ç•¥ç‰ˆã®JSONï¼ˆ`videos`/`playback_ids`ç­‰ï¼‰
- **--machineãƒ•ãƒ©ã‚°**: Mux APIã®å®Œå…¨ãªãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚€ï¼ˆ`raw_assets`/`raw_asset`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰

**å¯¾å¿œã‚³ãƒãƒ³ãƒ‰:**

| ã‚³ãƒãƒ³ãƒ‰ | é€šå¸¸å‡ºåŠ› | --machineå‡ºåŠ› |
|---------|---------|--------------|
| `list` | `videos`é…åˆ—ï¼ˆç°¡ç•¥ç‰ˆï¼‰ | `raw_assets`é…åˆ—ï¼ˆå®Œå…¨ãªAssetDataï¼‰ |
| `show` | åŸºæœ¬ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿ | `raw_asset`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆå®Œå…¨ãªAssetDataï¼‰ |
| `upload` | æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨URL | åŒå·¦ï¼ˆå¤‰æ›´ãªã—ï¼‰ |
| `delete` | asset_id | åŒå·¦ï¼ˆå¤‰æ›´ãªã—ï¼‰ |

**raw_assets/raw_assetã«å«ã¾ã‚Œã‚‹è¿½åŠ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¾‹:**

- `resolution_tier`: è§£åƒåº¦ãƒ†ã‚£ã‚¢ï¼ˆ1080p, 720pãªã©ï¼‰
- `encoding_tier`: ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ†ã‚£ã‚¢ï¼ˆbaseline, smartãªã©ï¼‰
- `max_stored_resolution`: æœ€å¤§ä¿å­˜è§£åƒåº¦
- `max_stored_frame_rate`: æœ€å¤§ä¿å­˜ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆ
- `tracks[].id`: ãƒˆãƒ©ãƒƒã‚¯ID
- `tracks[].max_width`: æœ€å¤§å¹…
- `tracks[].max_height`: æœ€å¤§é«˜ã•
- ãã®ä»–ã€Mux APIå…¬å¼ä»•æ§˜ã®å…¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

**ä½¿ç”¨ä¾‹:**

```bash
# é€šå¸¸ã®äººé–“å‘ã‘å‡ºåŠ›
vidyeet list

# ã‚¹ã‚¯ãƒªãƒ—ãƒˆå‘ã‘ã®å®Œå…¨ãªAPIãƒ‡ãƒ¼ã‚¿å–å¾—
vidyeet --machine list | jq '.raw_assets[0].resolution_tier'
vidyeet --machine show <asset_id> | jq '.raw_asset.encoding_tier'
```

**ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®è€ƒæ…®:**

`--machine`ãƒ•ãƒ©ã‚°ä½¿ç”¨æ™‚ã¯ã€å®Œå…¨ãªAPIãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¡ãƒ¢ãƒªã«ä¿æŒã™ã‚‹ãŸã‚ã€é€šå¸¸å®Ÿè¡Œã‚ˆã‚Šç´„50-200KBå¤šãæ¶ˆè²»ã—ã¾ã™ï¼ˆ100å‹•ç”»ã®å ´åˆï¼‰ã€‚CLIãƒ„ãƒ¼ãƒ«ã®ç‰¹æ€§ä¸Šã€ä¸€åº¦å®Ÿè¡Œã—ã¦çµ‚äº†ã™ã‚‹ãŸã‚ã€å®Ÿç”¨ä¸Šã®å•é¡Œã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

---

### Mux APIä»•æ§˜

è©³ç´°ã¯ [Mux API Reference](https://www.mux.com/docs/api-reference/video/assets) ã‚’å‚ç…§ã€‚

**ä¸»è¦ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ:**

- `POST /video/v1/uploads` - Direct Uploadä½œæˆ
- `GET /video/v1/uploads/{UPLOAD_ID}` - UploadçŠ¶æ…‹ç¢ºèª
- `GET /video/v1/assets/{ASSET_ID}` - Assetæƒ…å ±å–å¾—
- `GET /video/v1/assets` - Assetä¸€è¦§å–å¾—
- `DELETE /video/v1/assets/{ASSET_ID}` - Assetå‰Šé™¤

**èªè¨¼:** HTTP Basicèªè¨¼ï¼ˆAccess Token ID/Secretï¼‰

---

## å‚è€ƒè³‡æ–™

- [Mux Video API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.mux.com/)
- [Mux Direct Uploads ã‚¬ã‚¤ãƒ‰](https://docs.mux.com/guides/upload-files-directly)
- [Rustå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://doc.rust-lang.org/)
- [Clean Architecture](https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html)

---

## ä½œè€…

[@k4zunoko](https://github.com/k4zunoko)

---

**Built with â¤ï¸ and Rust ğŸ¦€**
